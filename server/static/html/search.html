<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.8.1/lottie.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/460/fabric.min.js"></script>
    <title>Dynamic Div Creation</title>
    <style>
        #results-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around; /* Adjust as needed */
        }

        .animation-container {
            max-width: calc(25% - 20px); /* Adjust as needed */
            margin: 10px;
        }
    </style>
</head>
<body>

<div>
    <label for="searchInput">Search:</label>
    <input type="text" id="searchInput" placeholder="Enter your search query">
    <button onclick="performSearch()">Search</button>
</div>

<div id="results-container"></div>

<script>
    function performSearch() {
        var searchQuery = document.getElementById('searchInput').value;

        var myHeaders = new Headers();
        myHeaders.append("Content-Type", "application/json");

        var raw = JSON.stringify({
            "search": searchQuery
        });

        var requestOptions = {
            method: 'POST',
            headers: myHeaders,
            body: raw,
            redirect: 'follow'
        };

        // Make API call
        fetch("http://localhost:8080/api/search", requestOptions)
            .then(response => response.json())
            .then(data => {
                console.log("Returned data ", data)
                // Process the response and create divs
                const resultsContainer = document.getElementById('results-container');
                resultsContainer.innerHTML = ""; // Clear previous results

                data.result.forEach(item => {
                    const newDiv = document.createElement('div');
                    newDiv.className = 'animation-container';

                    var textanimView = bodymovin.loadAnimation({
                        container: newDiv,
                        renderer: "svg",
                        loop: true,
                        rendererSettings: {
                            progressiveLoad: false
                        },
                        path: (item.url).split("?")[0]
                    });
                    resultsContainer.appendChild(newDiv);
                });
            })
            .catch(error => console.error('Error fetching data:', error));
    }
</script>

</body>
</html>
